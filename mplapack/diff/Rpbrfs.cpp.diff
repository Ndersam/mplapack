--- mplapack_old/mplapack/reference/Rpbrfs.cpp	2021-08-01 17:23:21.621787593 +0900
+++ mplapack/mplapack/reference/Rpbrfs.cpp	2021-08-01 15:53:29.421284953 +0900
@@ -178,9 +178,9 @@
         s = zero;
         for (i = 1; i <= n; i = i + 1) {
             if (work[i - 1] > safe2) {
-                s = max(s, abs(work[(n + i) - 1]) / work[i - 1]);
+                s = max(s, REAL(abs(work[(n + i) - 1]) / work[i - 1]));
             } else {
-                s = max(s, (abs(work[(n + i) - 1]) + safe1) / (work[i - 1] + safe1));
+                s = max(s, REAL((abs(work[(n + i) - 1]) + safe1) / (work[i - 1] + safe1)));
             }
         }
         berr[j - 1] = s;
@@ -260,7 +260,7 @@
         //
         lstres = zero;
         for (i = 1; i <= n; i = i + 1) {
-            lstres = max(lstres, abs(x[(i - 1) + (j - 1) * ldx]));
+            lstres = max(lstres, REAL(abs(x[(i - 1) + (j - 1) * ldx])));
         }
         if (lstres != zero) {
             ferr[j - 1] = ferr[j - 1] / lstres;
