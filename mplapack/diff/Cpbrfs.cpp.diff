--- mplapack_old/mplapack/reference/Cpbrfs.cpp	2021-08-01 17:23:21.617787538 +0900
+++ mplapack/mplapack/reference/Cpbrfs.cpp	2021-08-01 15:53:29.401284681 +0900
@@ -185,9 +185,9 @@
         s = zero;
         for (i = 1; i <= n; i = i + 1) {
             if (rwork[i - 1] > safe2) {
-                s = max(s, abs1(work[i - 1]) / rwork[i - 1]);
+                s = max(s, REAL(abs1(work[i - 1]) / rwork[i - 1]));
             } else {
-                s = max(s, (abs1(work[i - 1]) + safe1) / (rwork[i - 1] + safe1));
+                s = max(s, REAL((abs1(work[i - 1]) + safe1) / (rwork[i - 1] + safe1)));
             }
         }
         berr[j - 1] = s;
